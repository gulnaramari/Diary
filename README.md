LabBook ‚Äî —ç—Ç–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –¥–Ω–µ–≤–Ω–∏–∫–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ —Ü–∏—Ñ—Ä–æ–≤–æ–º –≤–∏–¥–µ.

–ó–∞—á–µ–º –Ω—É–∂–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

- –î–ª—è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è: –≤—Å–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å–æ–±—Ä–∞–Ω—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ. –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —Å—Ç–∞—Ç—É—Å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤, —É–¥–æ–±–Ω–æ –∫–∞—Ç–∞–ª–æ–≥–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ –∏ —Å–æ–±–∏—Ä–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

- –î–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: –Ω–µ –Ω—É–∂–Ω–æ –≤–µ—Å—Ç–∏ –±—É–º–∞–∂–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ –∏ –ø–µ—Ä–µ–ø–µ—á–∞—Ç—ã–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ –≤—Ä—É—á–Ω—É—é. –ó–∞–ø–∏—Å–∏ –¥–µ–ª–∞—é—Ç—Å—è —Å—Ä–∞–∑—É –≤ —Å–∏—Å—Ç–µ–º–µ, —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —É–¥–æ–±–Ω–æ–º –≤–∏–¥–µ, –∏—Ö –ª–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –∏–ª–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏.

- –î–ª—è –≤—Å–µ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏: –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π, –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞—Å—Ç—ë—Ç –≤–º–µ—Å—Ç–µ —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏.

–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
- —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –æ–± —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö
- –∫–∞—Ç–∞–ª–æ–≥–∏–∑–∞—Ü–∏—è –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º –∏ —Å—Ç–∞—Ç—É—Å–∞–º
- —Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ—Ç—á—ë—Ç–æ–≤ 
- —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º –≤ –±—É–¥—É—â–µ–º


–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ :
–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–µ Django
–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏–º–∏ –∑–∞–ø–∏—Å—è–º–∏ —Ç–µ–∫—É—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ API —Å Swagger


–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
–î–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è:

–£–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º Docker.
–£—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å Docker Hub.
–î–æ—Å—Ç—É–ø –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é –Ω–∞ GitHub.
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

sudo apt update
sudo apt upgrade
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ docker and docker-compose

sudo apt update && sudo apt install -y docker.io docker-compose
sudo systemctl enable docker
sudo usermod -aG docker $USER && newgrp docker
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞

3.1. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä - check the firewall status - sudo ufw status –ï—Å–ª–∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä –æ—Ç–∫–ª—é—á–µ–Ω, –≤–∫–ª—é—á–∏—Ç–µ –µ–≥–æ - sudo ufw enable

3.2. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã - http port: - sudo ufw allow 80/tcp

    - https port:
      - sudo ufw allow 443/tcp
 
    - ssh port:
      - sudo ufw allow 22/tcp
–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: \

git clone https://github.com/gulnaramari/Diary.git /var/www/config
cd /var/www/config
–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è. –í–æ—Ç –ø—Ä–∏–º–µ—Ä:

–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á Django

SECRET_KEY=1234567890op

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ

POSTGRES_DB=diary
POSTGRES_USER=postgres
POSTGRES_PASSWORD=SkyPro2025
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ö–æ—Å—Ç—ã

ALLOWED_HOSTS=localhost,127.0.0.1,example.com
–ó–∞–ø—É—Å–∫ –≤ production:
git clone https://github.com/gulnaramari/Diary.git /var/www/config \
cd /var/www/config

–í–∞–∂–Ω–æ:

Nginx –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 80
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –∏ –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞
Celery workers/beat –∑–∞–ø—É—Å—Ç—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD
1. –†–∞–∑–≤–µ—Ç–≤–∏—Ç–µ –∏–ª–∏ –∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
–†–∞–∑–≤–µ—Ç–≤–∏—Ç–µ —ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å GitHub, –µ—Å–ª–∏ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –≤–Ω–æ—Å–∏—Ç—å —Å–≤–æ–π –≤–∫–ª–∞–¥ –∏–ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö —Ç—Ä–µ–±—É—é—Ç—Å—è —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏. –í –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã, –∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ —Å–≤–æ–π –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä: git clone https://github.com/username/repository-name.git
cd repository-name

2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ secrets:
–∞) –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π —Ä–∞–∑–≤–µ—Ç–≤–ª–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub.
–±) –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Settings > Secrets and variables > Actions.
–≤) –î–æ–±–∞–≤—å—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ secrets, —Ç–∞–∫–∏–µ –∫–∞–∫:
DOTENV - —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ .env
(–∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–±—Ä–∞–∑—Ü–æ–º .env.sample)
DOCKER_HUB_USERNAME - –ª–æ–≥–∏–Ω Docker Hub
DOCKER_ACCESS_TOKEN - —Ç–æ–∫–µ–Ω Docker Hub
SSH_KEY - –∑–∞–∫—Ä—ã—Ç—ã–π SSH-–∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞
SSH_USER - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–µ—Ä–≤–µ—Ä–∞
SERVER_IP - IP-–∞–¥—Ä–µ—Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã
3. Workflow:
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ –∑–∞–ø—Ä–æ—Å—É push/pull \
–®–∞–≥–∏: ‚úÖ lint‚Üí ‚úÖ build ‚Üí üöÄ deploy\
–ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
(–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–ø–æ–ª–Ω–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ .env
–°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫:
docker-compose -f docker-compose.dev.yml up --build
–°–æ–∑–¥–∞—Ç—å —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
docker-compose -f docker-compose.dev.yml exec web python manage.py csu\
–ü–æ—Ä—Ç—ã:
Django: http://localhost:8000
PostgreSQL: 5432
Redis: 6379

–ê–≤–∞—Ä–∏–π–Ω—ã–µ –ö–æ–º–∞–Ω–¥—ã (–°–µ—Ä–≤–µ—Ä)

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose -f docker-compose.prod.yml logs -f

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose -f docker-compose.prod.yml up -d --build --force-recreate

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose -f docker-compose.prod.yml down -v
